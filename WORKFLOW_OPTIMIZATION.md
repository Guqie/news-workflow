# 新闻工作流优化方案

## 📊 当前状态分析

**已完成：**
- ✅ 多源新闻采集（1354条/次）
- ✅ 基础去重（标题相似度）
- ✅ CSV格式导出

**待解决：**
- ❌ 新闻正文内容爬取
- ❌ 精准的筛选规则
- ❌ 内容格式统一
- ❌ 多步智能筛选

---

## 🎯 核心问题分析

### 问题1：内容爬取难点

**现状：**
- 只有标题、链接、来源、时间
- 缺少新闻正文内容

**技术难点：**
1. 不同网站结构差异大
2. 部分网站需要JS渲染
3. 反爬虫机制
4. 爬取速度vs质量平衡

**解决方案对比：**

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| Newspaper4k | 简单，已集成 | 效果有限，成功率低 | 传统新闻网站 |
| Jina Reader API | 通用性强，转markdown | 需要API调用，有成本 | 所有网站 |
| BeautifulSoup | 灵活，可定制 | 需要为每个网站写规则 | 固定网站列表 |
| Playwright | 处理JS渲染 | 慢，资源消耗大 | 复杂网站 |

**推荐方案：**
- 主力：Jina Reader API（通用、稳定）
- 备用：Newspaper4k（免费、快速）
- 策略：先用Newspaper4k，失败则用Jina Reader

### 问题2：去重和筛选规则

**当前去重：**
- 标题相似度检测（基础）

**需要的筛选维度：**

**2.1 去重层面：**
- 标题去重：相似度>80%视为重复
- 内容去重：正文相似度>70%视为重复
- URL去重：同一URL只保留一条

**2.2 质量筛选：**
- 排除：股票投资类、股价波动、市场行情
- 排除：广告软文、企业宣传稿
- 保留：政策类、技术突破、企业动态、产业分析

**2.3 相关性筛选：**
- 必须包含：战略新兴产业或高科技产业关键词
- 排除：新能源汽车、风电、光伏（已在config.json中配置）

**筛选规则实现：**
```python
# 第一步：快速筛选（基于标题）
def quick_filter(title):
    # 排除关键词
    exclude_keywords = ['股价', '涨停', '跌停', '市值', '股票', 
                       '投资建议', '买入', '卖出', '持有']
    if any(kw in title for kw in exclude_keywords):
        return False
    return True

# 第二步：深度筛选（基于内容+大模型）
def deep_filter(news_item, reference_titles):
    # 使用大模型判断
    prompt = f"""
    参考历史标题：{reference_titles}
    
    新闻标题：{news_item['title']}
    新闻内容：{news_item['content'][:500]}
    
    判断这条新闻是否符合以下标准：
    1. 与战略新兴产业或高科技产业相关
    2. 不是股票投资类新闻
    3. 有实质性内容（非广告软文）
    
    返回：是/否，理由
    """
    # 调用大模型
    return llm_judge(prompt)
```

### 问题3：内容格式处理

**需要统一的格式：**
- 标题：清理HTML标签，统一标点
- 时间：统一为 YYYY-MM-DD HH:MM 格式
- 来源：统一来源名称
- 正文：清理广告、导航、版权信息
- 摘要：提取前200字或生成摘要

**格式化流程：**
```python
def format_news(news_item):
    return {
        'title': clean_title(news_item['title']),
        'source': normalize_source(news_item['source']),
        'time': parse_time(news_item['time']),
        'url': news_item['url'],
        'content': clean_content(news_item['content']),
        'summary': generate_summary(news_item['content']),
        'category': classify_news(news_item)
    }
```

### 问题4：多步筛选流程

**第一步：标题级快速筛选（低成本）**
- 去重：标题相似度检测
- 排除：股票投资类关键词
- 排除：明显不相关的新闻
- 目标：从1354条 → 约500条

**第二步：内容级深度筛选（大模型）**
- 参考：历史上传的新闻标题
- 判断：相关性、重要性、质量
- 生成：推荐理由和分类
- 目标：从500条 → 约100条

**第三步：人工审核（最终确认）**
- 查看：大模型推荐的100条
- 调整：删除不合适的，补充遗漏的
- 上传：最终50-80条

---

## 🤔 我识别的其他关键问题

### 5. 时效性问题
**问题：**
- 新闻发布时间是否准确？
- 如何确保获取的是最新新闻？

**解决方案：**
- 验证时间格式的准确性
- 设置时间窗口（只采集24小时内）
- 对无时间的新闻进行时间推断

### 6. 来源可信度
**问题：**
- 不同来源的权威性不同
- 如何给来源分配权重？

**解决方案：**
- 建立来源评级系统
- 权威媒体（新华社、人民网）：高权重
- 行业媒体（科创板日报）：中权重
- 一般网站：低权重

### 7. 分类标注
**问题：**
- 新闻属于哪个细分领域？
- 如何自动分类？

**解决方案：**
- 使用大模型自动分类
- 分类维度：
  - 一级：战略新兴产业/高科技产业
  - 二级：人工智能/芯片/航天/生物等
  - 三级：政策/技术/企业/市场

### 8. 数据存储和管理
**问题：**
- 历史数据如何存储？
- 如何快速检索历史新闻？

**解决方案：**
- 使用SQLite数据库存储
- 建立索引（时间、来源、分类）
- 定期归档旧数据




